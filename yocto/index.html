<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>yocto fly</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Encode+Sans+SC:wght@100;200;300;400&display=swap" rel="stylesheet">
  <style>
    *,*::before,*::after{box-sizing:border-box}
    html{-webkit-text-size-adjust:100%}
    body{
      margin:0;background:#0b0b0b;color:#eee;min-height:100vh;
      display:grid;place-items:center;padding:20px
    }
    .card{
      background:#161616;border:1px solid #2a2a2a;border-radius:16px;
      width:min(92vw,520px);
      padding:24px calc(24px + env(safe-area-inset-right)) 24px calc(24px + env(safe-area-inset-left));
      box-shadow:0 10px 30px rgba(0,0,0,.6)
    }
    h1{margin:0 0 16px 0;font-weight:400;font-family:'Encode Sans SC',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#eaeaea;letter-spacing:.5px}
    label{display:block;margin-bottom:6px;color:#cfcfcf}
    .field{margin-bottom:16px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    input,button,select{
      width:100%;padding:12px 14px;border-radius:10px;border:1px solid #2a2a2a;
      background:#0f0f0f;color:#f0f0f0;font-size:17px;-webkit-appearance:none;appearance:none
    }
    input::placeholder{color:#9a9a9a}
    .chips{display:flex;flex-wrap:wrap;gap:10px}
    .chip{
      display:inline-flex;align-items:center;justify-content:center;flex:0 0 auto;
      min-width:64px;padding:10px 12px;border-radius:999px;border:1px solid #2a2a2a;background:#0f0f0f;color:#e6e6e6
    }
    .chip:active{transform:translateY(1px)}
    .toggle{display:flex;gap:10px;margin-top:10px}
    .tgl{flex:1;display:grid;place-items:center;padding:12px;border-radius:10px;border:1px solid #2a2a2a;background:#0f0f0f;color:#cfcfcf}
    .tgl.active{background:#1e1e1e;color:#fff;border-color:#3a3a3a}
    .go{margin-top:14px}
    .hidden{display:none!important}

    /* --- PIN gate overlay --- */
    #gateOverlay{position:fixed;inset:0;background:#0b0b0b;display:grid;place-items:center;z-index:9999}
    #gate{
      width:min(92vw,420px);background:#161616;border:1px solid #2a2a2a;border-radius:16px;
      padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.6)
    }
    #gate h1{margin:0 0 8px 0;font-weight:400;font-family:'Encode Sans SC',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#eaeaea;letter-spacing:.5px}
    #pinDots{display:flex;gap:10px;justify-content:center;margin:12px 0 18px 0}
    .pinDot{width:14px;height:14px;border-radius:50%;border:1px solid #3a3a3a;background:#0f0f0f}
    .pinDot.fill{background:#e6e6e6}
    .pad{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .pad button{font-size:22px;padding:16px;border-radius:12px;border:1px solid #2a2a2a;background:#0f0f0f;color:#f0f0f0}
    .pad button:active{transform:translateY(1px)}
    .pad .ok{grid-column:3}
    .pad .clr{grid-column:1}
    .gateHint{margin-top:12px;color:#9a9a9a;font-size:12px;text-align:center}
  </style>
</head>
<body>

<!-- PIN Gate Overlay -->
<div id="gateOverlay">
  <div id="gate">
    <h1>yocto</h1>
    <div id="pinDots" aria-label="PIN progress">
      <div class="pinDot"></div><div class="pinDot"></div><div class="pinDot"></div><div class="pinDot"></div>
    </div>
    <div class="pad">
      <button type="button" data-k="1">1</button>
      <button type="button" data-k="2">2</button>
      <button type="button" data-k="3">3</button>
      <button type="button" data-k="4">4</button>
      <button type="button" data-k="5">5</button>
      <button type="button" data-k="6">6</button>
      <button type="button" data-k="7">7</button>
      <button type="button" data-k="8">8</button>
      <button type="button" data-k="9">9</button>
      <button type="button" class="clr" data-k="C">C</button>
      <button type="button" data-k="0">0</button>
      <button type="button" class="ok" data-k="OK">OK</button>
    </div>
    <div class="gateHint">Enter code to unlock</div>
  </div>
</div>

<!-- Main UI -->
<div class="card" id="appCard" aria-hidden="true">
  <h1>yocto</h1>

  <!-- Mode toggle -->
  <div class="toggle" role="tablist" aria-label="Search type">
    <button type="button" id="modeFlights" class="tgl active" role="tab" aria-selected="true">Flights</button>
    <button type="button" id="modeHotels" class="tgl" role="tab" aria-selected="false">Hotels</button>
  </div>

  <!-- Flights form -->
  <form id="flightForm" method="GET" action="https://api.hiner.nyc/fly/run" autocomplete="on">
    <div class="field">
      <div class="row">
        <input id="dep" name="departure" placeholder="From">
        <input id="arr" name="arrival" placeholder="To">
      </div>
      <div class="chips" id="depchips">
        <button type="button" class="chip" data-v="RDU">RDU</button>
        <button type="button" class="chip" data-v="GSO">GSO</button>
        <button type="button" class="chip" data-v="DCA">DCA</button>
        <button type="button" class="chip" data-v="JFK">JFK</button>
        <button type="button" class="chip" data-v="LGA">LGA</button>
        <button type="button" class="chip" data-v="EWR">EWR</button>
      </div>
    </div>

    <div class="field">
      <label for="arr">Destination</label>
      <div class="chips" id="arrchips">
        <button type="button" class="chip" data-v="HOME">HOME</button>
        <button type="button" class="chip" data-v="NYC">NYC</button>
        <button type="button" class="chip" data-v="LGA">LGA</button>
        <button type="button" class="chip" data-v="JFK">JFK</button>
        <button type="button" class="chip" data-v="DCA">DCA</button>
        <button type="button" class="chip" data-v="LAS">LAS</button>
        <button type="button" class="chip" data-v="MIA">MIA</button>
      </div>
    </div>

    <div class="field">
      <label for="date">Date</label>
      <input type="date" id="date" name="date">
    </div>

    <div class="field">
      <label>Cabin</label>
      <input type="hidden" id="class" name="class" value="first">
      <div class="toggle">
        <button type="button" id="first" class="tgl active">First</button>
        <button type="button" id="main" class="tgl">Main</button>
      </div>
    </div>

    <div class="go">
      <button type="submit" id="flightSubmit">Search Flights</button>
    </div>
  </form>

  <!-- Hotels form -->
  <form id="hotelForm" class="hidden" method="GET" action="https://api.hiner.nyc/hotels/run" autocomplete="on">
    <div class="field">
      <label for="city">Destination city</label>
      <input id="city" name="city" placeholder="City or airport (e.g., NYC)">
      <div class="chips" id="citychips">
        <button type="button" class="chip" data-v="NYC">NYC</button>
        <button type="button" class="chip" data-v="LAS">LAS</button>
        <button type="button" class="chip" data-v="MIA">MIA</button>
        <button type="button" class="chip" data-v="DCA">DCA</button>
      </div>
    </div>

    <div class="field">
      <div class="row">
        <div>
          <label for="checkin">Check-in</label>
          <input type="date" id="checkin" name="checkin">
        </div>
        <div>
          <label for="checkout">Check-out</label>
          <input type="date" id="checkout" name="checkout">
        </div>
      </div>
    </div>

    <div class="field">
      <div class="row">
        <div>
          <label for="rooms">Rooms</label>
          <input type="number" id="rooms" name="rooms" min="1" value="1">
        </div>
        <div>
          <label for="guests">Guests</label>
          <input type="number" id="guests" name="guests" min="1" value="1">
        </div>
      </div>
    </div>

    <div class="go">
      <button type="submit" id="hotelSubmit">Search Hotels</button>
    </div>
  </form>
</div>

<script>
  // --- small helpers
  function hookChips(containerId, targetInput){
    var c = document.getElementById(containerId);
    if(!c) return;
    c.querySelectorAll('.chip').forEach(function(b){
      b.addEventListener('click', function(){
        document.getElementById(targetInput).value = b.dataset.v;
      });
    });
  }
  hookChips('depchips','dep');
  hookChips('arrchips','arr');
  hookChips('citychips','city');

  // Cabin toggle (flights)
  (function(){
    var main = document.getElementById('main'),
        first = document.getElementById('first'),
        cls = document.getElementById('class');
    function setC(v){
      cls.value = v;
      if(v==='first'){ first.classList.add('active'); main.classList.remove('active'); }
      else { main.classList.add('active'); first.classList.remove('active'); }
    }
    if (main && first) {
      main.onclick = function(){ setC('main') };
      first.onclick = function(){ setC('first') };
    }
  })();

  // Default dates
  (function(){
    // flight date = tomorrow
    var fd = document.getElementById('date');
    if (fd){ var d = new Date(); d.setDate(d.getDate()+1); fd.value = d.toISOString().slice(0,10); }
    // hotel dates = check-in tomorrow, check-out +2
    var ci = document.getElementById('checkin'), co = document.getElementById('checkout');
    if (ci && co){
      var t1 = new Date(); t1.setDate(t1.getDate()+1);
      var t2 = new Date(); t2.setDate(t2.getDate()+3);
      ci.value = t1.toISOString().slice(0,10);
      co.value = t2.toISOString().slice(0,10);
    }
  })();

  // Mode toggle
  (function(){
    var flightsBtn = document.getElementById('modeFlights');
    var hotelsBtn  = document.getElementById('modeHotels');
    var flightForm = document.getElementById('flightForm');
    var hotelForm  = document.getElementById('hotelForm');

    function setMode(mode){
      var isFlights = (mode === 'flights');
      flightsBtn.classList.toggle('active', isFlights);
      flightsBtn.setAttribute('aria-selected', String(isFlights));
      hotelsBtn.classList.toggle('active', !isFlights);
      hotelsBtn.setAttribute('aria-selected', String(!isFlights));
      flightForm.classList.toggle('hidden', !isFlights);
      hotelForm.classList.toggle('hidden', isFlights);
      document.title = isFlights ? 'yocto fly' : 'yocto stay';
    }
    flightsBtn.addEventListener('click', function(){ setMode('flights'); });
    hotelsBtn.addEventListener('click', function(){ setMode('hotels'); });
    setMode('flights'); // default
  })();

  // --- PIN gate logic ---
  (function(){
    var correct = "1123";
    var entered = "";
    var gate = document.getElementById('gateOverlay');
    var app  = document.getElementById('appCard');
    var dots = Array.prototype.slice.call(document.querySelectorAll('#pinDots .pinDot'));

    function setUnlocked(){
      gate.classList.add('hidden');
      app.removeAttribute('aria-hidden');
      localStorage.setItem('yocto_unlocked','1');
    }
    if (localStorage.getItem('yocto_unlocked') === '1') { setUnlocked(); return; }

    function renderDots(){ dots.forEach(function(d,i){ d.classList.toggle('fill', i < entered.length); }); }
    function reset(msg){
      entered = ""; renderDots();
      if (msg) gate.querySelector('.gateHint').textContent = msg;
      else gate.querySelector('.gateHint').textContent = 'Enter code to unlock';
    }
    function press(k){
      if(k==="C"){ reset(); return; }
      if(k==="OK"){
        if(entered===correct){ setUnlocked(); }
        else { reset('Wrong code'); }
        return;
      }
      if(entered.length<4 && /\d/.test(k)){ entered += k; renderDots(); }
    }

    gate.querySelectorAll('[data-k]').forEach(function(btn){
      btn.addEventListener('click', function(){ press(btn.getAttribute('data-k')); });
    });
    window.addEventListener('keydown', function(e){
      if(gate.classList.contains('hidden')) return;
      if(e.key>='0' && e.key<='9'){ press(e.key); }
      if(e.key==='Enter'){ press('OK'); }
      if(e.key==='Backspace' || e.key==='Escape'){ press('C'); }
    });
    renderDots();
  })();
</script>

</body>
</html>