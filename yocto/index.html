<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="noindex">
<title>Yocto Hotels</title>
<style>
body {font-family: sans-serif; display:flex; justify-content:center; 
align-items:center; height:100vh; margin:0; background:#f5f5f5;}
#login, #form {display:flex; flex-direction:column; gap:1rem; width:90%; 
max-width:400px;}
input, button {font-size:1.2rem; padding:0.5rem;}
label {display:flex; justify-content:space-between; align-items:center;}
</style>
</head>
<body>
<div id="login">
  <input type="password" id="pass" placeholder="Password">
  <button id="login-btn">Enter</button>
</div>
<div id="form" style="display:none;">
  <input type="text" id="where" placeholder="Where?">
  <input type="text" id="when" placeholder="When?" readonly>
  <input type="date" id="when-picker" style="display:none;">
  <label>Nights
    <input type="number" id="nights" min="1" value="1">
  </label>
  <button id="search">Search</button>
</div>
<script>
const PASSWORD = "yocto"; // change to secure password
const loginBtn = document.getElementById('login-btn');
loginBtn.addEventListener('click', () => {
  if (document.getElementById('pass').value === PASSWORD) {
    document.getElementById('login').style.display='none';
    document.getElementById('form').style.display='flex';
  }
});

const whenField = document.getElementById('when');
const picker = document.getElementById('when-picker');
function formatDate(d){
  return d.toLocaleDateString('en-US',{weekday:'short', month:'short', 
day:'2-digit'});
}
function tomorrowISO(){
  const d = new Date();
  d.setDate(d.getDate()+1);
  return d.toISOString().split('T')[0];
}
picker.value = tomorrowISO();
whenField.value = formatDate(new Date(picker.value));
whenField.addEventListener('click', () => picker.showPicker && 
picker.showPicker());
picker.addEventListener('change', () => {
  whenField.value = formatDate(new Date(picker.value));
});

document.getElementById('search').addEventListener('click', () => {
  const where = document.getElementById('where').value.trim();
  const checkIn = picker.value;
  const nights = parseInt(document.getElementById('nights').value,10) || 
1;
  const ci = new Date(checkIn);
  const co = new Date(ci);
  co.setDate(ci.getDate()+nights);
  const data = {
    where,
    check_in: checkIn,
    check_out: co.toISOString().split('T')[0]
  };
  fetch('run_search', {method:'POST', 
headers:{'Content-Type':'application/json'}, body: JSON.stringify(data)})
    .then(res => res.ok ? res.json() : Promise.reject(res))
    .then(() => window.location.href='results.html')
    .catch(err => alert('Error initiating search'));
});
</script>
</body>
</html>
